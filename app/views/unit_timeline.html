<div ng-include="'views/partials/setting_accordion.html'"></div>
<div class="row">
  <div class="col-sm-3">
  	<h2>Joukko-osastot</h2>
	<p>Hae viime sotien joukko-osastoja kirjoittamalla tekstiä alla olevaan täydennyskenttään ja/tai valitse joukko-osasto kentän alla olevasta listasta.
Joukko-osaston tapahtumat ilmestyvät kartalle ja aikajanalle keskelle (sikäli kun niistä on tietoa) ja osastoon liittyvät muut tiedot ja suosittelulinkit näkyvät oikealle.</p>
    <input type="text" placeholder="Hae joukko-osaston nimellä, esim. 1. Divisioona" class="form-control" ng-model="ctrl.queryregex" ng-change="ctrl.getItems()">
    <select ng-model="ctrl.current" ng-change="ctrl.updateUnit()" size="32" class="form-control" id="unitselect"
            ng-options="item as item.name for item in ctrl.items"></select>
	</div>

  <div class="col-sm-9">
    <div class="row">
      <div class="col-lg-5 col-lg-push-7 col-md-12">
        <div class="row">
          <div class="col-md-12">
            <div ng-show="ctrl.current">
              <h3 ng-if="ctrl.current && ctrl.current.name">{{ ctrl.label ? ctrl.label : ctrl.current.name }}</h3>
              <p ng-if="ctrl.current && ctrl.current.altNames">Osasto on tunnettu myös nimillä {{ ctrl.current.altNames.join('; ') }}</p>
              <div ng-show="ctrl.current.relatedEvents.length ===0">
                Ei osastoon liittyviä tapahtumia.
              </div>
              <p ng-if="ctrl.current && ctrl.current.id"><a ng-href="units/page?uri={{ ctrl.current.id }}">Näytä osaston tietosivu</a></p>
              <h3 ng-if="ctrl.current.opts.descTitle">
                <span ng-repeat="place in ctrl.current.opts.event.places">
                  <a page-link="place.id">{{ place.label }}</a>{{ $last ? ' ' : ', ' }}
                </span>
                {{ ctrl.current.opts.descTitle }} - {{ ctrl.current.opts.event.type }}
              </h3>
              <p>{{ ctrl.current.opts.description }}</p>
              <related-links data-title="'Henkilöitä'" data-related="ctrl.current.relatedPersons"></related-links>
              <related-links data-title="'Yläosasto'" data-related="ctrl.current.superUnits"></related-links>
              <related-links data-title="'Alaosastoja'" data-related="ctrl.current.subUnits"></related-links>
              <related-links data-title="'Muita osastoja'" data-related="ctrl.current.relatedUnits"></related-links>
              <related-links data-title="'Taistelut'" data-related="ctrl.current.battles"></related-links>
              <related-links data-title="'Paikat'" data-related="ctrl.current.places"></related-links>
              <related-links data-title="'Kansa Taisteli -artikkelit'" data-related="ctrl.current.articles"></related-links>
              <related-links data-external data-title="'Sotapäiväkirjat'" data-related="ctrl.current.diaries"></related-links>

              <p ng-repeat="unit in ctrl.current.units" style="text-transform: capitalize">
              {{ unit.label.join(' / ') }}
              </p>

              <photo-gallery data-images="ctrl.images"></photo-gallery>
            </div>
            <div ng-if="!ctrl.current">
              <h3>Valitse osasto valikosta.</h3>
              <p>
              Kartan alla on kaksi yhdessä liikkuvaa aikajanaa.
              Ylempi on yleiskuva sodasta (pystyviivojen väli on yksi kuukausi).
              Tämän janan keskellä on mustana laatikkona viikon mittainen aikaikkuna,
              jonka sisään osuvat tapahtumat näkyvät alemmalla janalla.
              Alemmassa aikajanassa pystyviivojen väli on yksi päivä.
              Aikajanoja voi liikuttaa vetämällä niitä hiirellä sivuttaissuunnassa.
              </p>
              <p>
              Valitsemalla tapahtuman aikajanalta tai kartalta saat lisätietoja siitä.
              Tekstiltään <span style="color: blue">sinisiin</span> tapahtumiin liittyy valokuvia.
              </p>
              <p>
              Kartalla näkyvät viikon aikaikkunan tapahtumat, jos niiden paikka on tiedossa.
              Lisäksi kartalla näkyy lämpökartta aikaikkunan sisällä sodassa menehtyneistä suomalaisista.
              </p>
              <p>
              Asetuksia, kuten valokuvien haun aikahaarukkaa, voi muuttaa valitsemalla yläpalkista "Asetukset". Tämän ohjeen saat näkyviin valitsemalla yläpalkista "Näkymän ohjeet".
              </p>
              <h4>Tapahtumien värikoodit</h4>
              <p><img src="vendor/timemap/images/red-circle.png"> Sotatoimi</p>
              <p><img src="vendor/timemap/images/purple-circle.png"> Poliittinen tapahtuma</p>
              <p><img src="vendor/timemap/images/orange-circle.png"> Muu tapahtuma</p>
              <p><img src="vendor/timemap/images/green-circle.png"> Tällä hetkellä valittu tapahtuma</p>
            </div>
            <hr/>
            <div id="casualtyCount" ng-click="ctrl.showCasualtyStats = !ctrl.showCasualtyStats">
              <p>Osastosta menehtyneitä ajanjaksolla {{ ctrl.minVisibleDate.toLocaleDateString() }} - {{ ctrl.maxVisibleDate.toLocaleDateString() }}: {{ ctrl.casualtyCount }}
              | <a ng-show="!timemapCtrl.showCasualtyStats">Näytä lisätietoja</a>
              <a ng-show="timemapCtrl.showCasualtyStats">Piilota lisätiedot</a>
              </p>
            </div>
            <div class="row animate-text" ng-if="ctrl.showCasualtyStats" ng-repeat="casualtyClass in ctrl.casualtyStats">
              <div ng-if="casualtyClass.id">
                <div class="col-xs-10 casualtyCount">
                  {{ casualtyClass.description }}
                </div>
                <div class="col-xs-2 casualtyCount">
                  {{ casualtyClass.count }}
                </div>
              </div>
            </div>
            <div class="row" ng-repeat="person in ctrl.current.related_people">
              <div class="col-md-12" style="text-transform: capitalize">
                <h4>
                  {{ person.sotilasarvo.toLowerCase() }} {{ person.etunimet.toLowerCase() }} {{ person.sukunimi.toLowerCase() }}
                </h4>
                <div class="row">
                  <div class="col-xs-6">
                    Kuolinaika:
                  </div>
                  <div class="col-xs-6">
                    {{ person.kuolinaika }}
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-6">
                    Kuolinpaikka:
                  </div>
                  <div class="col-xs-6">
                    {{ person.kuolinpaikka }}
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-6">
                    Menehtymisluokka:
                  </div>
                  <div class="col-xs-6" style="text-transform: none">
                    {{ person.menehtymisluokka }}
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-6">
                    Ammatti:
                  </div>
                  <div class="col-xs-6">
                    {{ person.ammatti }}
                  </div>
                </div>
                <div class="row">
                  <div class="col-xs-6">
                    Siviilisääty:
                  </div>
                  <div class="col-xs-6">
                    {{ person.siviilisaeaety }}
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="col-lg-7 col-lg-pull-5 col-md-12">
        <div id="timemap" class="animate-right">
          <div id="mapcontainer">
            <div id="map"></div>
          </div>
          <div id="timelinecontainer">
            <div id=timeline></div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
